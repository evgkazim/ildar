<!DOCTYPE html>
<html>
<head>
	<title>TEST</title>
	<meta chatset="utf-8">
	<style>
		div {
			padding: 5px;
		}
	</style>
</head>
<body>
    <script>
		var init = true;
		var id_sub_system = 0;
		
        function add_sub_system() {
			if(document.getElementById("add_sub_system_name").value.length == 0){
				alert("Enter a subsystem name!");
				return;
			}
			if(init) {
				var div = document.createElement("div");
				div.innerHTML = '<div id=data></div><div id=output><div id=result></div><button onclick="calc()">Расчитать</button></div>';	
				document.body.appendChild(div);
				init = false;
			}
			document.getElementById("data").innerHTML += 
			'<div name=d0>' +
				'<label> Имя подсистемы: ' + document.getElementById("add_sub_system_name").value + ' </label>' +
				'<button onclick="add_sub_sub_system(' + id_sub_system + ')">Добавить</button>' + 
				'<button onclick="del(this,true)">Удалить</button>' +
				'<div name="d1"></div>' +
			'</div>';
			id_sub_system++;
        }
		function add_sub_sub_system(id) {
			document.getElementById("data").children[id].children.d1.innerHTML += 
			'<div>' +
				'<label> ВБР </label><input id="a" type="text">' +
				'<label> количество </label><input id="b" type="text">' +
				'<label> стоимость </label><input id="c" type="text">' +
				'<button onclick="del(this,false)">Удалить</button>' +
			'</div>';
		}
		function del(id, is_sub) {
			if(is_sub) {
				id_sub_system--;
			}
			id.parentNode.parentNode.removeChild(id.parentNode);
		}
		
		function calc() {
			var out = document.getElementById("result");
			out.innerHTML = "";
			
			var data = document.getElementById('data');
			for (var i = 0; i < data.childElementCount; i++) {
				var v = 1;
				var o = {};/
				var a = data.children[i].children[3];
				out.innerHTML += '<label> Id подсистемы = ' + (i + 1) + '</label><br>'
				for (var j = 0; j < a.childElementCount; j++) {
					var b = a.children[j];
					v *= Math.pow(b.children[1].value, b.children[3].value);
					out.innerHTML += '<label>ВБР=' + b.children[1].value + ', количество=' + b.children[3].value + ', стоимость=' + b.children[5].value + '</label><br>'
				}
				out.innerHTML += '<label>ВБР подсистемы = ' + v + '</label><br>'
			}
			
			out.innerHTML += '<label>Общее ВБР=</label><br>'
			out.innerHTML += '<label>Что-то там=</label><br>'
		}
    </script>
		<div id="head">
		<h2>Оптимизация ИСБ</h2>
		<h4>Имя подсистемы</h4>
		<input id="add_sub_system_name" type="text">
		<button onclick="add_sub_system()">Добавить подсистему</button>
		<h4>Выделенные деньги для оптимизации</h4>
		<input id="money" type="number">
    </div>
</body>
</html>	